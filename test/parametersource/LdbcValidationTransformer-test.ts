import { LdbcValidationTransformer } from '../../lib/parametersource/LdbcValidationTransformer';
import { QueryParameters } from '../../lib/QueryParameters';

describe('LdbcValidationTransformer', () => {
  let transformer: LdbcValidationTransformer;

  beforeEach(() => {
    transformer = new LdbcValidationTransformer();
  });

  describe('parseLine', () => {
    it('parses a simple line', () => {
      expect(transformer.parseLine(`["q1",123,"Chau",20]|[[1],[2],[3]]`))
        .toEqual(new QueryParameters(
          'q1',
          [ 123, 'Chau' ],
          [
            [ 1 ],
            [ 2 ],
            [ 3 ],
          ],
        ));
    });

    it('parses a complex line', () => {
      expect(transformer.parseLine(`["com.ldbc.driver.workloads.ldbc.snb.interactive.LdbcQuery1",30786325583618,"Chau",20]|[[9101,"Do",2,508118400000,1263974569507,"female","Firefox","110.35.68.136",["Chau9101@yahoo.com"],["vi","en"],"Quảng_Ngãi",[["Ton_Duc_Thang_University",2008,"Ho_Chi_Minh_City"]],[["Bulgarian_Air_Charter",2009,"Bulgaria"],["Air_Mekong",2009,"Vietnam"],["VietJet_AirAsia",2009,"Vietnam"],["Jetstar_Pacific_Airlines",2009,"Vietnam"]]],[15393162793500,"Ha",2,618969600000,1304408159735,"female","Chrome","124.157.44.116",["Chau15393162793500@gmx.com"],["vi","en"],"Tân_An",[],[["Jetstar_Pacific_Airlines",2010,"Vietnam"]]],[10995116285282,"Ho",2,324432000000,1291557365272,"female","Firefox","119.18.131.12",["Chau10995116285282@gmail.com","Chau10995116285282@gmx.com"],["vi","en"],"Tuy_Hòa",[["Ton_Duc_Thang_University",2002,"Ho_Chi_Minh_City"]],[["Far_Eastern_Air_Transport",2003,"Taiwan"],["CHC_Airways",2002,"Netherlands"],["Indochina_Airlines",2003,"Vietnam"]]],[19791209303405,"Ho",2,375148800000,1312010662774,"female","Chrome","112.78.3.35",["Chau19791209303405@gmail.com","Chau19791209303405@gmx.com"],["vi","en"],"Thái_Nguyên",[["Ho_Chi_Minh_City_University_of_Foreign_Languages_and_Information_Technology",2002,"Ho_Chi_Minh_City"]],[]],[28587302323020,"Ho",2,607737600000,1333712897061,"female","Firefox","61.11.238.114",["Chau28587302323020@gmail.com","Chau28587302323020@gmx.com"],["vi","fr","en"],"Tuy_Hòa",[["Hanoi_Medical_University",2010,"Hanoi"]],[["Air_Mekong",2010,"Vietnam"],["Indochina_Airlines",2011,"Vietnam"],["Boliviana_de_Aviación",2010,"Bolivia"]]],[32985348842021,"Ho",2,451958400000,1344373393678,"female","Internet Explorer","180.93.127.114",["Chau32985348842021@gmail.com","Chau32985348842021@gmx.com","Chau32985348842021@yahoo.com"],["vi","en"],"Tuy_Hòa",[["Hanoi_Architectural_University",2005,"Hanoi"]],[["Aerodavinci",2005,"Mexico"],["KoralBlue_Airlines",2006,"Egypt"],["Jetstar_Pacific_Airlines",2005,"Vietnam"]]],[6597069771031,"Loan",2,416275200000,1282821614628,"female","Firefox","125.253.115.83",["Chau6597069771031@gmail.com","Chau6597069771031@yahoo.com"],["vi","zh","en"],"Điện_Biên_Phủ",[["Van_Xuan_University_of_Technology",2004,"Nghe_An_province"]],[["Vietnam_Airlines",2005,"Vietnam"]]],[13194139544258,"Loan",2,412214400000,1294961064793,"female","Internet Explorer","49.156.52.220",["Chau13194139544258@gmail.com","Chau13194139544258@gmx.com","Chau13194139544258@yahoo.com"],["vi","en"],"Biên_Hòa",[],[]],[26388279076217,"Loan",2,361497600000,1331208649065,"female","Opera","27.118.25.118",["Chau26388279076217@gmail.com","Chau26388279076217@yahoo.com"],["vi","fr","en"],"Bạc_Liêu",[["Hanoi_Architectural_University",1999,"Hanoi"]],[["Air_Mekong",2000,"Vietnam"],["VietJet_AirAsia",2000,"Vietnam"],["Vietnam_Airlines",2001,"Vietnam"],["Jetstar_Pacific_Airlines",2000,"Vietnam"]]],[4848,"Nguyen",2,580176000000,1263666270970,"female","Internet Explorer","118.70.133.154",["Chau4848@gmx.com"],["vi","en"],"Cần_Thơ",[["Ton_Duc_Thang_University",2006,"Ho_Chi_Minh_City"]],[["Air_Mekong",2006,"Vietnam"],["Jetairfly",2007,"Belgium"],["VietJet_AirAsia",2006,"Vietnam"],["Vietnam_Airlines",2007,"Vietnam"],["Jetstar_Pacific_Airlines",2008,"Vietnam"]]],[2199023265573,"Nguyen",2,600825600000,1271190573798,"female","Internet Explorer","119.18.132.229",["Chau2199023265573@gmail.com","Chau2199023265573@hotmail.com"],["vi","fr","en"],"Cua_Lo",[["University_of_Technology_and_Education",2009,"Hung_Yen_province"]],[["Air_Mekong",2009,"Vietnam"],["Vietnam_Airlines",2010,"Vietnam"],["Jetstar_Pacific_Airlines",2009,"Vietnam"]]],[8796093031224,"Nguyen",2,460080000000,1287616948181,"female","Firefox","183.90.165.164",["Chau8796093031224@gmx.com"],["vi","zh","en"],"Thái_Nguyên",[["Le_Quy_Don_Technical_University",2003,"Hanoi"]],[["Air_Mekong",2005,"Vietnam"],["VietJet_AirAsia",2003,"Vietnam"],["Jetstar_Pacific_Airlines",2003,"Vietnam"]]],[26388279068635,"Nguyen",2,525398400000,1328809489352,"female","Chrome","103.3.250.4",["Chau26388279068635@gmail.com","Chau26388279068635@gmx.com"],["vi","zh","en"],"Điện_Biên_Phủ",[["Ton_Duc_Thang_University",2008,"Ho_Chi_Minh_City"]],[["Air_Mekong",2010,"Vietnam"],["Indochina_Airlines",2010,"Vietnam"]]],[28587302322743,"Nguyen",2,576720000000,1333121518684,"female","Internet Explorer","115.165.164.99",["Chau28587302322743@yahoo.com"],["vi","zh","en"],"Đà_Lạt",[["Le_Quy_Don_Technical_University",2009,"Hanoi"]],[["Vietnam_Airlines",2010,"Vietnam"],["Jetstar_Pacific_Airlines",2009,"Vietnam"]]],[15393162789090,"Ha",3,542332800000,1301347899476,"female","Chrome","49.213.90.77",["Chau15393162789090@yahoo.com"],["vi","fr","en"],"Bạc_Liêu",[["Ho_Chi_Minh_City_University_of_Information_Technology",2006,"Ho_Chi_Minh_City"]],[["Indochina_Airlines",2006,"Vietnam"],["VietJet_AirAsia",2006,"Vietnam"],["Jetstar_Pacific_Airlines",2007,"Vietnam"],["Aurora_Airlines",2007,"Slovenia"]]],[32985348840129,"Ho",3,419904000000,1342016628636,"female","Internet Explorer","182.237.21.245",["Chau32985348840129@gmail.com","Chau32985348840129@gmx.com"],["vi","en"],"Biên_Hòa",[["Ton_Duc_Thang_University",2004,"Ho_Chi_Minh_City"]],[["VietJet_AirAsia",2005,"Vietnam"]]],[10995116284332,"Loan",3,486777600000,1291253096004,"female","Firefox","49.246.209.53",["Chau10995116284332@gmail.com","Chau10995116284332@gmx.com"],["vi","en"],"Hanoi",[["Ton_Duc_Thang_University",2006,"Ho_Chi_Minh_City"]],[["Air_Mekong",2008,"Vietnam"],["Vietnam_Airlines",2007,"Vietnam"],["Jetstar_Pacific_Airlines",2006,"Vietnam"]]],[26388279072379,"Nguyen",3,332121600000,1326561996617,"female","Internet Explorer","124.158.10.90",["Chau26388279072379@yahoo.com"],["vi","fr","en"],"Thái_Nguyên",[],[["Air_Mekong",2002,"Vietnam"]]]]`))
        .toEqual(new QueryParameters(
          'com.ldbc.driver.workloads.ldbc.snb.interactive.LdbcQuery1',
          [ 30_786_325_583_618, 'Chau' ],
          [
            [
              9_101,
              'Do',
              2,
              508_118_400_000,
              1_263_974_569_507,
              'female',
              'Firefox',
              '110.35.68.136',
              [
                'Chau9101@yahoo.com',
              ],
              [
                'vi',
                'en',
              ],
              'Quảng_Ngãi',
              [
                [
                  'Ton_Duc_Thang_University',
                  2_008,
                  'Ho_Chi_Minh_City',
                ],
              ],
              [
                [
                  'Bulgarian_Air_Charter',
                  2_009,
                  'Bulgaria',
                ],
                [
                  'Air_Mekong',
                  2_009,
                  'Vietnam',
                ],
                [
                  'VietJet_AirAsia',
                  2_009,
                  'Vietnam',
                ],
                [
                  'Jetstar_Pacific_Airlines',
                  2_009,
                  'Vietnam',
                ],
              ],
            ],
            [
              15_393_162_793_500,
              'Ha',
              2,
              618_969_600_000,
              1_304_408_159_735,
              'female',
              'Chrome',
              '124.157.44.116',
              [
                'Chau15393162793500@gmx.com',
              ],
              [
                'vi',
                'en',
              ],
              'Tân_An',
              [],
              [
                [
                  'Jetstar_Pacific_Airlines',
                  2_010,
                  'Vietnam',
                ],
              ],
            ],
            [
              10_995_116_285_282,
              'Ho',
              2,
              324_432_000_000,
              1_291_557_365_272,
              'female',
              'Firefox',
              '119.18.131.12',
              [
                'Chau10995116285282@gmail.com',
                'Chau10995116285282@gmx.com',
              ],
              [
                'vi',
                'en',
              ],
              'Tuy_Hòa',
              [
                [
                  'Ton_Duc_Thang_University',
                  2_002,
                  'Ho_Chi_Minh_City',
                ],
              ],
              [
                [
                  'Far_Eastern_Air_Transport',
                  2_003,
                  'Taiwan',
                ],
                [
                  'CHC_Airways',
                  2_002,
                  'Netherlands',
                ],
                [
                  'Indochina_Airlines',
                  2_003,
                  'Vietnam',
                ],
              ],
            ],
            [
              19_791_209_303_405,
              'Ho',
              2,
              375_148_800_000,
              1_312_010_662_774,
              'female',
              'Chrome',
              '112.78.3.35',
              [
                'Chau19791209303405@gmail.com',
                'Chau19791209303405@gmx.com',
              ],
              [
                'vi',
                'en',
              ],
              'Thái_Nguyên',
              [
                [
                  'Ho_Chi_Minh_City_University_of_Foreign_Languages_and_Information_Technology',
                  2_002,
                  'Ho_Chi_Minh_City',
                ],
              ],
              [],
            ],
            [
              28_587_302_323_020,
              'Ho',
              2,
              607_737_600_000,
              1_333_712_897_061,
              'female',
              'Firefox',
              '61.11.238.114',
              [
                'Chau28587302323020@gmail.com',
                'Chau28587302323020@gmx.com',
              ],
              [
                'vi',
                'fr',
                'en',
              ],
              'Tuy_Hòa',
              [
                [
                  'Hanoi_Medical_University',
                  2_010,
                  'Hanoi',
                ],
              ],
              [
                [
                  'Air_Mekong',
                  2_010,
                  'Vietnam',
                ],
                [
                  'Indochina_Airlines',
                  2_011,
                  'Vietnam',
                ],
                [
                  'Boliviana_de_Aviación',
                  2_010,
                  'Bolivia',
                ],
              ],
            ],
            [
              32_985_348_842_021,
              'Ho',
              2,
              451_958_400_000,
              1_344_373_393_678,
              'female',
              'Internet Explorer',
              '180.93.127.114',
              [
                'Chau32985348842021@gmail.com',
                'Chau32985348842021@gmx.com',
                'Chau32985348842021@yahoo.com',
              ],
              [
                'vi',
                'en',
              ],
              'Tuy_Hòa',
              [
                [
                  'Hanoi_Architectural_University',
                  2_005,
                  'Hanoi',
                ],
              ],
              [
                [
                  'Aerodavinci',
                  2_005,
                  'Mexico',
                ],
                [
                  'KoralBlue_Airlines',
                  2_006,
                  'Egypt',
                ],
                [
                  'Jetstar_Pacific_Airlines',
                  2_005,
                  'Vietnam',
                ],
              ],
            ],
            [
              6_597_069_771_031,
              'Loan',
              2,
              416_275_200_000,
              1_282_821_614_628,
              'female',
              'Firefox',
              '125.253.115.83',
              [
                'Chau6597069771031@gmail.com',
                'Chau6597069771031@yahoo.com',
              ],
              [
                'vi',
                'zh',
                'en',
              ],
              'Điện_Biên_Phủ',
              [
                [
                  'Van_Xuan_University_of_Technology',
                  2_004,
                  'Nghe_An_province',
                ],
              ],
              [
                [
                  'Vietnam_Airlines',
                  2_005,
                  'Vietnam',
                ],
              ],
            ],
            [
              13_194_139_544_258,
              'Loan',
              2,
              412_214_400_000,
              1_294_961_064_793,
              'female',
              'Internet Explorer',
              '49.156.52.220',
              [
                'Chau13194139544258@gmail.com',
                'Chau13194139544258@gmx.com',
                'Chau13194139544258@yahoo.com',
              ],
              [
                'vi',
                'en',
              ],
              'Biên_Hòa',
              [],
              [],
            ],
            [
              26_388_279_076_217,
              'Loan',
              2,
              361_497_600_000,
              1_331_208_649_065,
              'female',
              'Opera',
              '27.118.25.118',
              [
                'Chau26388279076217@gmail.com',
                'Chau26388279076217@yahoo.com',
              ],
              [
                'vi',
                'fr',
                'en',
              ],
              'Bạc_Liêu',
              [
                [
                  'Hanoi_Architectural_University',
                  1_999,
                  'Hanoi',
                ],
              ],
              [
                [
                  'Air_Mekong',
                  2_000,
                  'Vietnam',
                ],
                [
                  'VietJet_AirAsia',
                  2_000,
                  'Vietnam',
                ],
                [
                  'Vietnam_Airlines',
                  2_001,
                  'Vietnam',
                ],
                [
                  'Jetstar_Pacific_Airlines',
                  2_000,
                  'Vietnam',
                ],
              ],
            ],
            [
              4_848,
              'Nguyen',
              2,
              580_176_000_000,
              1_263_666_270_970,
              'female',
              'Internet Explorer',
              '118.70.133.154',
              [
                'Chau4848@gmx.com',
              ],
              [
                'vi',
                'en',
              ],
              'Cần_Thơ',
              [
                [
                  'Ton_Duc_Thang_University',
                  2_006,
                  'Ho_Chi_Minh_City',
                ],
              ],
              [
                [
                  'Air_Mekong',
                  2_006,
                  'Vietnam',
                ],
                [
                  'Jetairfly',
                  2_007,
                  'Belgium',
                ],
                [
                  'VietJet_AirAsia',
                  2_006,
                  'Vietnam',
                ],
                [
                  'Vietnam_Airlines',
                  2_007,
                  'Vietnam',
                ],
                [
                  'Jetstar_Pacific_Airlines',
                  2_008,
                  'Vietnam',
                ],
              ],
            ],
            [
              2_199_023_265_573,
              'Nguyen',
              2,
              600_825_600_000,
              1_271_190_573_798,
              'female',
              'Internet Explorer',
              '119.18.132.229',
              [
                'Chau2199023265573@gmail.com',
                'Chau2199023265573@hotmail.com',
              ],
              [
                'vi',
                'fr',
                'en',
              ],
              'Cua_Lo',
              [
                [
                  'University_of_Technology_and_Education',
                  2_009,
                  'Hung_Yen_province',
                ],
              ],
              [
                [
                  'Air_Mekong',
                  2_009,
                  'Vietnam',
                ],
                [
                  'Vietnam_Airlines',
                  2_010,
                  'Vietnam',
                ],
                [
                  'Jetstar_Pacific_Airlines',
                  2_009,
                  'Vietnam',
                ],
              ],
            ],
            [
              8_796_093_031_224,
              'Nguyen',
              2,
              460_080_000_000,
              1_287_616_948_181,
              'female',
              'Firefox',
              '183.90.165.164',
              [
                'Chau8796093031224@gmx.com',
              ],
              [
                'vi',
                'zh',
                'en',
              ],
              'Thái_Nguyên',
              [
                [
                  'Le_Quy_Don_Technical_University',
                  2_003,
                  'Hanoi',
                ],
              ],
              [
                [
                  'Air_Mekong',
                  2_005,
                  'Vietnam',
                ],
                [
                  'VietJet_AirAsia',
                  2_003,
                  'Vietnam',
                ],
                [
                  'Jetstar_Pacific_Airlines',
                  2_003,
                  'Vietnam',
                ],
              ],
            ],
            [
              26_388_279_068_635,
              'Nguyen',
              2,
              525_398_400_000,
              1_328_809_489_352,
              'female',
              'Chrome',
              '103.3.250.4',
              [
                'Chau26388279068635@gmail.com',
                'Chau26388279068635@gmx.com',
              ],
              [
                'vi',
                'zh',
                'en',
              ],
              'Điện_Biên_Phủ',
              [
                [
                  'Ton_Duc_Thang_University',
                  2_008,
                  'Ho_Chi_Minh_City',
                ],
              ],
              [
                [
                  'Air_Mekong',
                  2_010,
                  'Vietnam',
                ],
                [
                  'Indochina_Airlines',
                  2_010,
                  'Vietnam',
                ],
              ],
            ],
            [
              28_587_302_322_743,
              'Nguyen',
              2,
              576_720_000_000,
              1_333_121_518_684,
              'female',
              'Internet Explorer',
              '115.165.164.99',
              [
                'Chau28587302322743@yahoo.com',
              ],
              [
                'vi',
                'zh',
                'en',
              ],
              'Đà_Lạt',
              [
                [
                  'Le_Quy_Don_Technical_University',
                  2_009,
                  'Hanoi',
                ],
              ],
              [
                [
                  'Vietnam_Airlines',
                  2_010,
                  'Vietnam',
                ],
                [
                  'Jetstar_Pacific_Airlines',
                  2_009,
                  'Vietnam',
                ],
              ],
            ],
            [
              15_393_162_789_090,
              'Ha',
              3,
              542_332_800_000,
              1_301_347_899_476,
              'female',
              'Chrome',
              '49.213.90.77',
              [
                'Chau15393162789090@yahoo.com',
              ],
              [
                'vi',
                'fr',
                'en',
              ],
              'Bạc_Liêu',
              [
                [
                  'Ho_Chi_Minh_City_University_of_Information_Technology',
                  2_006,
                  'Ho_Chi_Minh_City',
                ],
              ],
              [
                [
                  'Indochina_Airlines',
                  2_006,
                  'Vietnam',
                ],
                [
                  'VietJet_AirAsia',
                  2_006,
                  'Vietnam',
                ],
                [
                  'Jetstar_Pacific_Airlines',
                  2_007,
                  'Vietnam',
                ],
                [
                  'Aurora_Airlines',
                  2_007,
                  'Slovenia',
                ],
              ],
            ],
            [
              32_985_348_840_129,
              'Ho',
              3,
              419_904_000_000,
              1_342_016_628_636,
              'female',
              'Internet Explorer',
              '182.237.21.245',
              [
                'Chau32985348840129@gmail.com',
                'Chau32985348840129@gmx.com',
              ],
              [
                'vi',
                'en',
              ],
              'Biên_Hòa',
              [
                [
                  'Ton_Duc_Thang_University',
                  2_004,
                  'Ho_Chi_Minh_City',
                ],
              ],
              [
                [
                  'VietJet_AirAsia',
                  2_005,
                  'Vietnam',
                ],
              ],
            ],
            [
              10_995_116_284_332,
              'Loan',
              3,
              486_777_600_000,
              1_291_253_096_004,
              'female',
              'Firefox',
              '49.246.209.53',
              [
                'Chau10995116284332@gmail.com',
                'Chau10995116284332@gmx.com',
              ],
              [
                'vi',
                'en',
              ],
              'Hanoi',
              [
                [
                  'Ton_Duc_Thang_University',
                  2_006,
                  'Ho_Chi_Minh_City',
                ],
              ],
              [
                [
                  'Air_Mekong',
                  2_008,
                  'Vietnam',
                ],
                [
                  'Vietnam_Airlines',
                  2_007,
                  'Vietnam',
                ],
                [
                  'Jetstar_Pacific_Airlines',
                  2_006,
                  'Vietnam',
                ],
              ],
            ],
            [
              26_388_279_072_379,
              'Nguyen',
              3,
              332_121_600_000,
              1_326_561_996_617,
              'female',
              'Internet Explorer',
              '124.158.10.90',
              [
                'Chau26388279072379@yahoo.com',
              ],
              [
                'vi',
                'fr',
                'en',
              ],
              'Thái_Nguyên',
              [],
              [
                [
                  'Air_Mekong',
                  2_002,
                  'Vietnam',
                ],
              ],
            ],
          ],
        ));
    });
  });
});
